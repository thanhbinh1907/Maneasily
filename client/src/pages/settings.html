<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cài đặt - Maneasily</title>
  <script>
    (function() {
      const savedTheme = localStorage.getItem('theme');
      const savedLang = localStorage.getItem('language') || 'vi';
      document.documentElement.setAttribute('lang', savedLang);
      if (savedTheme === 'dark') document.documentElement.setAttribute('data-theme', 'dark');
    })();
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <link rel="stylesheet" href="/src/css/components/dashboard-layout.css">
  <link rel="stylesheet" href="/src/css/pages/settings.css"> 
</head>
<body>

  <div class="app-container">
    {{> sidebar active_settings=true }}

    <div class="app-main">
        {{> nav-top }}

        <div class="page-content">
            <div class="settings-container">
                <h1 class="page-title" data-i18n="settings.title">Cài đặt</h1>

                <div class="settings-layout">
                    <aside class="settings-sidebar">
                        <nav class="settings-nav">
                            <button class="nav-btn active" data-tab="tab-account">
                                <i class="fa-regular fa-user"></i> <span data-i18n="settings.tab_account">Tài khoản</span>
                            </button>
                            <button class="nav-btn" data-tab="tab-general">
                                <i class="fa-solid fa-palette"></i> <span data-i18n="settings.tab_general">Chung & Giao diện</span>
                            </button>
                            <button class="nav-btn" data-tab="tab-notifications">
                                <i class="fa-regular fa-bell"></i> <span data-i18n="settings.tab_notif">Thông báo</span>
                            </button>
                            <button class="nav-btn" data-tab="tab-privacy">
                                <i class="fa-solid fa-lock"></i> <span data-i18n="settings.tab_privacy">Riêng tư</span>
                            </button>
                        </nav>
                    </aside>

                    <main class="settings-content">
                        
                        <div id="tab-account" class="settings-tab active">
                            <div class="settings-card">
                                <h3 data-i18n="settings.header_personal">Thông tin cá nhân</h3>
                                <div class="form-group">
                                    <label data-i18n="settings.lbl_avatar">Avatar (URL)</label>
                                    <div style="display: flex; gap: 15px; align-items: center;">
                                        <img id="preview-avatar" src="" class="avatar-preview">
                                        <input type="text" id="set-avatar" class="form-input" placeholder="https://...">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="settings.lbl_displayname">Tên hiển thị</label>
                                    <input type="text" id="set-username" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label data-i18n="settings.lbl_email">Email</label>
                                    <input type="text" id="set-email" class="form-input" disabled style="background: var(--bg-hover); cursor: not-allowed;">
                                </div>
                            </div>

                            <div class="settings-card danger-zone">
                                <h3 style="color: #d93025;" data-i18n="settings.danger_zone">Vùng nguy hiểm</h3>
                                <div class="danger-item">
                                    <div>
                                        <strong data-i18n="settings.change_password">Đổi mật khẩu</strong>
                                        <p data-i18n="settings.change_pass_desc">Bạn sẽ nhận được email để đặt lại mật khẩu.</p>
                                    </div>
                                    <button id="btn-reset-pass" class="btn-danger-outline" data-i18n="settings.send_req">Gửi yêu cầu</button>
                                </div>
                            </div>
                        </div>

                        <div id="tab-general" class="settings-tab">
                            <div class="settings-card">
                                <h3 data-i18n="settings.header_appearance">Giao diện</h3>
                                <div class="form-group">
                                    <label data-i18n="settings.lbl_theme">Chế độ hiển thị</label>
                                    <select id="set-theme" class="form-select">
                                        <option value="light" data-i18n="settings.theme_light">Sáng (Light)</option>
                                        <option value="dark" data-i18n="settings.theme_dark">Tối (Dark)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="settings.lbl_lang">Ngôn ngữ</label>
                                    <select id="set-lang" class="form-select">
                                        <option value="vi">Tiếng Việt</option>
                                        <option value="en">English</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div id="tab-notifications" class="settings-tab">
                            <div class="settings-card">
                                <h3><i class="fa-regular fa-envelope" style="margin-right: 8px;"></i> <span data-i18n="settings.via_email">Qua Email</span></h3>
                                <p style="margin-bottom: 20px; font-size: 0.9rem; color: var(--text-sub);" data-i18n="settings.email_desc">
                                    Chọn những email bạn muốn nhận.
                                </p>
                        
                                <div class="toggle-item">
                                    <div class="toggle-info">
                                        <strong data-i18n="settings.notif_invite">Lời mời & Cộng tác</strong>
                                        <p data-i18n="settings.notif_invite_desc">Khi có người mời bạn vào dự án hoặc giao việc cho bạn.</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="notif-email-invite"> <span class="slider round"></span>
                                    </label>
                                </div>
                        
                                <div class="toggle-item" style="flex-wrap: wrap;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                                        <div class="toggle-info">
                                            <strong data-i18n="settings.notif_deadline">Nhắc nhở hạn chót (Deadline)</strong>
                                            <p data-i18n="settings.notif_deadline_desc">Gửi cảnh báo khi công việc sắp hết hạn.</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="deadline-enable-toggle"> 
                                            <span class="slider round"></span>
                                        </label>
                                    </div>

                                    <div id="deadline-options" style="width: 100%; display: none; margin-top: 15px; padding-left: 10px; padding-top: 15px; border-top: 1px dashed var(--border-color); animation: fadeIn 0.3s;">
                                        <div style="display: flex; gap: 20px;">
                                            <div style="flex: 1;">
                                                <label style="font-size: 0.85rem; color: var(--text-sub); display: block; margin-bottom: 5px;">
                                                    Nhắc trước (Ngày)
                                                </label>
                                                <input type="number" id="deadline-days" min="0" max="30" class="form-input" style="padding: 6px 10px;" placeholder="VD: 1">
                                            </div>
                                            <div style="flex: 1;">
                                                <label style="font-size: 0.85rem; color: var(--text-sub); display: block; margin-bottom: 5px;">
                                                    Khẩn cấp (Giờ)
                                                </label>
                                                <input type="number" id="deadline-hours" min="0" max="24" class="form-input" style="padding: 6px 10px;" placeholder="VD: 2">
                                            </div>
                                        </div>
                                        <p style="font-size: 0.75rem; color: var(--text-placeholder); margin-top: 8px;">
                                            * Hệ thống sẽ gửi mail nhắc nhở vào 7:00 sáng (theo ngày) và kiểm tra mỗi 30 phút (theo giờ).
                                        </p>
                                    </div>
                                </div>
                                </div>
                            
                            <div class="settings-card">
                                <h3><i class="fa-regular fa-bell" style="margin-right: 8px;"></i> <span data-i18n="settings.in_app">Trong ứng dụng</span></h3>
                                
                                <div class="toggle-item">
                                    <div class="toggle-info">
                                        <strong data-i18n="settings.notif_sound">Âm thanh thông báo</strong>
                                        <p data-i18n="settings.notif_sound_desc">Phát tiếng "Ting" khi có thông báo mới.</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="notif-sound"> <span class="slider round"></span>
                                    </label>
                                </div>
                        
                                <div class="toggle-item">
                                    <div class="toggle-info">
                                        <strong data-i18n="settings.notif_toast">Thông báo nổi (Toast)</strong>
                                        <p data-i18n="settings.notif_toast_desc">Hiện hộp thoại nhỏ góc màn hình khi có cập nhật mới.</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="notif-toast"> <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                            
                        <div id="tab-privacy" class="settings-tab">
                            <div class="settings-card">
                                <h3 data-i18n="settings.header_privacy">Quyền riêng tư</h3>
                                <p style="margin-bottom: 20px; font-size: 0.9rem; color: var(--text-sub);" data-i18n="settings.privacy_desc">
                                    Kiểm soát cách người khác tương tác với tài khoản của bạn.
                                </p>
                        
                                <div class="toggle-item">
                                    <div class="toggle-info">
                                        <strong data-i18n="settings.priv_search">Cho phép tìm kiếm</strong>
                                        <p data-i18n="settings.priv_search_desc">Người khác có thể tìm thấy bạn qua Email hoặc Tên người dùng.</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="priv-searchable">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                        
                                <div class="toggle-item">
                                    <div class="toggle-info">
                                        <strong data-i18n="settings.priv_invite">Yêu cầu phê duyệt tham gia</strong>
                                        <p data-i18n="settings.priv_invite_desc">Khi được mời, bạn sẽ không bị thêm tự động mà cần phải nhấn "Đồng ý".</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="priv-require-invite">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="settings-actions">
                            <button id="btn-save-settings" class="btn-primary-large" data-i18n="settings.save_btn">Lưu thay đổi</button>
                        </div>
                    </main>
                </div>
            </div>
        </div>
    </div>
  </div>

  {{> confirm-modal }}
  
  <script type="module" src="/src/js/dashboard.js"></script>
  <script type="module" src="/src/js/settings.js"></script> 
</body>
</html>